
- . 아키텍처나 구조를 바꿀때 장애 해결이나 트래픽 문제를 해결할때 
-  아키텍처를 변경하면서 발생하는 문제 백엔드 8팀 데브옵스 4팀 

2022년 인프런 아키텍처 ㅣㄹ뷰 
복잡한 문제를 쉽게 해결하기
구체적 문제와 해결책
다음 개선점


거대한 레거시에서 좌우로 백엔드와 프론트를 신규로 진행함

1년이 지나서 변한 아키텍처는 없음

2022년 7월에 조직형태가 변화했음
사람이 적고 코드가 적어서 개발 속도가 빨랐음

이전에는 PM, Design, Dev팀이 있었고 각 목표가 달랐음

cell이라고 하는 하나의 목적을 가진 목적 조직을 만들고 각 팀을 만듬
-> cell내부에서 제품을 탐당하도록 만듬

실행력, 당장의 제품속도가 올라갔지만 장기적 제품 속도, 조직 안정감이 내려감
-> 제품 지표개선이 우선이고 내부 코드 개선이 후위로 밀린다.
-> 결국 서비스를 우선하게 되는 문제가 생김
-> 부족한 시니어의 숫자
	-> 부족한 시니어의 숫자
-> pm, design등 1명씩 존재하는 직군에서 퇴사자가 발생하면?


조직 구성 개선

모적 조직 _ 직군 조직

파트별로 위키를 만듬

모든 PR은 파트 공융 채널에 공유

#### 기술적인 이야기 
1개의 레거시 프로젝트 N개의 목적 조직

모든 목적 조직이 사용하는 거대한 레거시 시스템
5개 조직이 기능을 추가하니깐 늘어나는 빌드 속도, 뒤썩이는 commit로그 서로 영향 받는 QA

거대한 단일 레거시 시스템의 개편은 어느 조직의 목표인지 확인하는 **회색 영역**이 생김 


#### 복잡한 문제 해결

소규모 팀이 비즈니스 속도를 낼 수 없음 -> 마이크로서비스를 쓰지마라

복잡한 문제를 해결하는 황금망치는 **분할 정복** 

레거시를 각 조직에 맞는 형태로 분할하고 각 팀이 담당하도록 함
-> 회색 조직이 없고 격리된 상태로 진행함
-> 레거시 개편이 목적 조직의 목표가 된다.

### 구체적 문제와 해결책
1개의 서비스가 N개의 프로젝트로 분할 N배로 증설해야할 인프라
코드 복제뿐만 아니라 인프라 계층 전체의 복제가 늘어남

Iac(Infrastructure as code)
현재의 서비스 인프라를 언제든 사용할 수 있도록 함

pulumi로 레거시 인프라를 언제든 쉽고,복잡한 기술 설계가 가능함

pulumi를 사용하면 선언형 언어가 아니라서 IDE 활용, 추상화된 설계 가능
-> 개발자가 직접 관리할 수 있음


Load Balancer vs Cloud Front

S3, API Gateway등 + EC2, Load Balancer Lambda포함하여 다양한 서비스로 라우팅이 가능함

계속햇 URL PATH 단위로 변화가 필요하기 때문에 단일 EndPoint를 사용하는 GraphQL을 지금 도입할 수 없음


SNS-SQS 비동기 아키텍처
- SNS 이벤트를 발행만 하면 되는 도메인 의존성 분리, SQS를 통해 각각의 프로젝트가 최종적 일관성을 보장함

트랜잭션이 플요한 곳에서는 사용하지 않는다. 여러 로직이 비동기로 실행되도 무방할때 상요


#### 단일 DB의 문제점
테이블 변경 사항에 대한 전체 조직 Sync
문제가 되는 SQL 출처 파악
중복된 도메인 클래스 관리

### 중복된 도메인 클래스 관리
모든 DDL에 대한 단일 채널 람

불확실한 미래에는 어설픈 추상화.공통화 보다는 삭제하기 쉬운 중복이 낫다.

도메인에 종속적이지 않은 공통 유틸ㄹ클래스는. github registry로 관리한다.


