

## 등장 배경
MySQL5.6 이전 버전에서 레플리카 서버는 하나의 스레드로만 동기화가 가능했습니다. 그러다 보니 짧은 시간 동안 ==다량의 DML 쿼리가 실행되는 경우 복제 동기화에 지연이 발생==했습니다.


## 동작 방식
![[Pasted image 20240422212220.png]]
 [[../MySQL 복제 아키텍처|MySQL 복제 아키텍처]]
멀티 스레드 복제에서 SQL 스레드는 [[코디네이터 스레드]]와 워커 스레드가 협업해서 동기화를 진행합니다.

1. 코디네이터 스레드가 릴레이 로그 파일에서 이벤트를 읽음
2. 설정된 방식에 따라 스케줄링
3. 워커 스레드 큐에 적재된 이벤트들을 꺼내 레플리카 서버에 할당


멀티 스레드 복제는 소스 서버로부터 복제된 트랜잭션들을 어떻게 병렬로 처리할 것인가에 따라
- [[데이터베이스 기반 멀티 스레드 복제]]
- [[LOGICAL CLOCK 기반 멀티 스레드 복제]]
두 방식으로 나뉜다. 

## 사용하는 옵션

- `slave_parallel_type`: 어떤 처리 방식으로 멀티 스레드 동기화를 진행할지 설정
	- 데이터베이스 기반 방식
- `slave_parallel_workers`: 워커 스레드 개수를 지정
	- 0~1024까지 설정
	- 0으로 설정하는 경우 단일 스레드 모드로 수행
- `slave_pending_jobs_size_max`: 워커 스레드의 큐에 할당할 수 있는 최대 메모리 크기 설정
