---
cssclasses:
  - my_style_width_100
---
# 용어
- 물리 모델링 


컬럼의 데이터 타입과 길이 선정 시 주의점 
1. 저장되는 값의 성격에 맞는 최적의 타입 선정
2. 가변 길이 컬럼은 최적의 길이 지정
3. 조인 조건으로 사용되는 컬럼은 똑같은 데이터 타입으로 선정 


> 컬럼의 데이터 타입을 선정할 때 실제 저장되는 값의 특성을 고려하지 않고 가능한 최대 길이 값을 기준으로 컬럼의 길이를 선택하는 것이 일반적


# 문자열(char와 varchar)

`char` vs `varchar`


## 저장 공간
- char는 고정 길이 
- varchar는 가변 길이

> ⚠ 고정길이
> 고정 길이는 실제 입력되는 컬럼의 길이에 따라 사용하는 저장 공간의 크기가 변하지 않음
> CHAR 타입은 저장 공간의 크기가 고정이며 실제 저장된 값의 유효 크기가 얼마인지 별도로 저장할 필요가 없으므로 추가로 공간이 필요하지 않음

> ⚠ 가변 길이
> 가변 길이는 최대로 저장할 수 있는 값의 길이는 제한돼 있지만, 그 이하 크기의 값이 저장되면 그만큼 저장 공간이 줄어든다.
> 하지만 varchar 타입은 저장된 값의 유효 크기가 얼마인지를 별도로 저장해 둬야 하므로 1~2바이트의 저장 공간이 추가로 필요함

- char(1), varchar(1) 타입을 각각 사용할 때 두 문자열 타입 모두 한 글자를 저장할 때 사용하는 문자 집합에 따라 실제 저장 공간을 1~4바이트까지 사용

공통점
- char, varchar 모두 한 글자를 저장할 때 1~4바이트 사용 (utf의 경우 4바이트

차이점
- varchar의 경우 저장할 문자열의 길이를 관리하기 위한 1~2바이트의 공간을 추가로 필요로 합니다
	- `255바이트 이하면 1바이트만 사용하고 256바이트 이상은 2바이트를 추가로 사용`
	- varchar 타입의 최대 길이는 2바이트로 표현할 수 있는 이상은 사용할 수 없습니다. (2^16 = 65,536)

추가
- MySQL TEXT, BLOB 타입을 제외한 컬럼의 전체 크기가 64kb를 초과할 수 없습니다.
- A 컬럼에서 40kb를 사용하고 있다면 B컬럼에서는 24kb만 사용할 수 있습니다.
- 만약 초과하게 된다면 VARCHAR 타입이 TEXT 타입으로 대체됩니다.

![[Pasted image 20240323185352.png]]

왜 16383바이트 보다 큰 값을 저장할 수 없는가
- 사용하고 있는 콜레이션에서 한 글자당 4바이트를 사용하고 있기 때문에 ceil(65536 / 4)가 컬럼이 가질 수 있는 최대 바이트 값



그럼 무엇을 써야 할까?
- 문자열 값의 길이가 항상 일정하다면 char를 사용하고 가변적이라면 varchar를 사용하는 것이 일반적입니다.
- varchar타입을 선택해도 디스크에서 1바이트만 더 사용한다면 고민할 필요 없이 varchar를 사용하는게 맞지 않을까?

- 실제 문자열 값의 길이가 정적인지 가변인지 여부로 char, varchar타입을 결정하는 것은 적절하지 않습니다.

RealMysQL에서는 두 가지 기준을 제시 
1. 저장되는 문자열의 길이가 대개 비슷한가?
2. 컬럼의 값이 자주 변경되는가?

=> 값의 길이도 중요하지만, 칼럼의 값의 변경 빈도가 높은지가 기준이 돼야 함



SMP(Supplementary Multilingual Plane) & SIP(Supplementary Ideographic Plane)


![[Pasted image 20240323205308.png]]

tb_test테이블에 레코드 1건을 저장하면 내부적으로 디스크에는 아래와 같이 저장됩니다. 
![[Pasted image 20240323205335.png]]

여기서 char(10) -> varchar(10)으로 변경하면 아래와 같이 적용됩니다.
![[Pasted image 20240323205358.png]]

